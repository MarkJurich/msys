# Makefile for man -- message catalogue subdirectory.
# Source: Makefile.in -- processed by configure, to create Makefile.
#
# Copyright (C) 2006, Keith D. Marshall <keithmarshall@users.sourceforge.net>
#
# (Based on, and replacing, an unaccredited original implementation, believed
#  to be the work of John W. Eaton and/or Andries E. Brouwer).
#
# This file is part of the man package.
#
# man is free software; you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation; either version 2, or (at your option) any later version.
#
# man is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
# details.
#
# You should have received a copy of the GNU General Public License along
# with man; see the file COPYING.  If not, write to the Free Software
# Foundation, 51 Franklin St - Fifth Floor, Boston, MA 02110-1301, USA.

srcdir = @srcdir@
top_builddir = `cd @top_builddir@;pwd`

MKMSGS = ${top_builddir}/tools/makemsg
GENCAT = @man_gencat_program@

all: stamp.cat

stamp.cat: Makefile
	rm -f *.cat
	for i in `cd ${srcdir}; echo mess.??`; \
	  do echo $(MKMSGS) -c ${srcdir}/$$i msgs.tmp; \
	    $(MKMSGS) -c ${srcdir}/$$i msgs.tmp; \
	    echo "cat ${srcdir}/$$i.codeset msgs.tmp > catin.tmp"; \
	    cat ${srcdir}/$$i.codeset msgs.tmp > catin.tmp; \
	    echo LC_ALL=en_US.UTF-8 $(GENCAT) $$i.cat catin.tmp; \
	    LC_ALL=en_US.UTF-8 $(GENCAT) $$i.cat catin.tmp; \
	  done
	rm -f core *.stackdump *.tmp
	echo timestamp > $@

nl_catdir = ${localedir}/@nl_catdir@
nl_catfile = ${nl_catdir}/@nl_catfile@
localedir = ${DESTDIR}@localedir@
languages = @languages@

MKINSTALLDIRS = `cd @top_srcdir@;pwd`/mkinstalldirs
INSTALL = @INSTALL@

install: stamp.cat
	test -z "${DESTDIR}" || $(MKINSTALLDIRS) ${localedir}
	N=man; \
	for L in $(languages); \
	  do if test -f mess.$$L.cat; \
	    then \
	      $(MKINSTALLDIRS) --require ${localedir} ${nl_catdir}; \
	      echo >&2 "$(INSTALL) -m 444 mess.$$L.cat ${nl_catfile}"; \
	      $(INSTALL) -m 444 mess.$$L.cat ${nl_catfile}; \
	    else \
	      echo >&2 "$(INSTALL) -m 444 mess.$$L.cat ${nl_catfile}"; \
	      echo >&2 "install: mess.$$L.cat: no message catalogue available"; \
	    fi; \
	  done

clean:
	rm -f *.cat *~ *.tmp *.stackdump core

distclean realclean spotless: clean
	rm -f Makefile *.orig *.rej

# $RCSfile: Makefile.in,v $: end of file
